# Rust-like formatting for C/C++ (via clang-format)
# - 4-space indent
# - 100-col line width
# - Attach braces (K&R)
# - One-per-line args/params when wrapped
# - Minimal alignment (avoid lining up operators/tokens)
# - Trailing commas when lists wrap (stable diffs, like rustfmt)

# Start from Google style, then override:
BasedOnStyle: Google
Language: Cpp

# Core layout to mimic rustfmt feel
IndentWidth: 4
TabWidth: 4
UseTab: Never
ContinuationIndentWidth: 4
ColumnLimit: 100
BreakBeforeBraces: Attach

# Prefer multi-line over cramming tiny constructs on one line
AllowShortFunctionsOnASingleLine: Empty
AllowShortIfStatementsOnASingleLine: Never
AllowShortLoopsOnASingleLine: false
AllowShortBlocksOnASingleLine: Empty

# Arguments/parameters: when a call/decl wraps, go one-per-line
BinPackArguments: false
BinPackParameters: false

# Initializer lists: one-per-line when they don’t all fit
ConstructorInitializerAllOnOneLineOrOnePerLine: true
BreakConstructorInitializers: AfterColon
PackConstructorInitializers: Never

# Make wrapped lists stable (similar to Rust’s trailing commas)
InsertTrailingCommas: Wrapped

# Keep comments tidy like rustfmt
ReflowComments: true

# Minimize “visual alignment” (rustfmt avoids this)
AlignConsecutiveAssignments: false
AlignConsecutiveDeclarations: false
AlignConsecutiveMacros: false
AlignOperands: DontAlign
AlignTrailingComments: false

# Put binary operators at the end of the previous line when wrapping
# (closest to rustfmt’s common style)
BreakBeforeBinaryOperators: None

# Avoid auto-breaking string literals (Rust won’t split strings)
BreakStringLiterals: false

# Spacing similar to Rust’s clean, tight style
SpaceBeforeParens: ControlStatements
SpacesInParentheses: false
SpacesInCStyleCastParentheses: false
SpaceInEmptyBlock: false
SpaceBeforeRangeBasedForLoopColon: true

# Switch/case: indent labels like Rust match arms are indented
IndentCaseLabels: true

# Keep at most one empty line, and don’t keep empties at block starts
MaxEmptyLinesToKeep: 1
KeepEmptyLinesAtTheStartOfBlocks: false

# Reference/pointer token placement (your project preference)
DerivePointerAlignment: false
PointerAlignment: Right
ReferenceAlignment: Right  # ensures "int& foo" rather than "int &foo"

# --- Your existing include policy (kept as-is) ---
IncludeBlocks: Merge
SortIncludes: true
IncludeCategories:
  # Matches common headers first, but sorts them after project includes
  - Regex: '^\"google/cloud/internal/disable_deprecation_warnings.inc\"$'
    Priority: -1
  - Regex: '^\"google/cloud/(internal/|grpc_utils/|testing_util/|[^/]+\.h)'
    Priority: 1000
  - Regex: '^\"google/cloud/'  # project includes should sort first
    Priority: 500
  - Regex: '^\"'
    Priority: 1500
  - Regex: '^<grpc/'
    Priority: 2000
  - Regex: '^<google/*'
    Priority: 3000
  - Regex: '^<.*/.*'
    Priority: 4000
  - Regex: '^<[^/]*>'
    Priority: 5000

# Format raw string literals with a `pb` or `proto` tag as proto.
RawStringFormats:
  - Language: TextProto
    Delimiters:
      - 'pb'
      - 'proto'
    BasedOnStyle: Google

# Project-specific comment pragma
CommentPragmas: '(@copydoc)'

